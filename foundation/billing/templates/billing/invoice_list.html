{% extends "core/base_private.html" %}
{% load i18n %}
{% load humanize %}
{% load staticfiles %}
{% block page_title %}
<title>{{ config.company_name }} - {% trans "Invoices" %}</title>
{% endblock %}
{% block head_style %}
    {{ block.super }}
    <style>
        table.grid tbody tr td.payment-method a.button {height: 19px; padding-top: 3px; width: 72px}
        form#filter input {height: 21px}
        table.grid tbody td {padding: 0 0 0 6px}
    </style>
{% endblock %}

{% block profile_custom_menu_items %}
    <li class="invoice">
        <a href="{% url 'billing:invoice_list' %}" title="{% trans "View your invoices" %}">{% trans "Invoices" %}</a>
        {% if pending_invoice_count > 0 %}
        <div class="badge-text">{{ pending_invoice_count }}</div>
        {% endif %}
    </li>
{% endblock %}

{% block content  %}
    <div id="content">
        <div class="wrapper" style="margin-top: 72px">
            <header>{% trans "My Invoices" %}</header>
            {% if invoices %}
                <form id="filter" style="float: right">
                    <div style="width: 260px">
                        <input type="text" placeholder="{% trans "From" %}" id="id_due_date_start"  class="date start due_date" style="width: 120px">
                        <input type="hidden" name="due_date_start" />
                        <input type="text" placeholder="{% trans "To" %}" id="id_due_date_finish"  class="date end due_date" style="width: 120px">
                        <input type="hidden" name="due_date_finish" />
                    </div>
                    <button class="confirm" style="height: 25px; margin: 1px 0 0 7px; padding: 2px 0 3px; text-align: center; width: 100px">{% trans "Filter" %}</button>
                </form>
                {% if pending_invoices_count > 1 %}
                    <div id="pending-summary"></div>
                {% endif %}
                <div class="" style="float: left; margin: 24px 0">
                    <table cellspacing="0" class="grid">
                        <thead>
                            <tr>
                                <td style="width: 300px">{% trans "Product" %}</td>
                                <td style="width: 160px">{% trans "Amount" %}</td>
                                <td style="width: 150px">{% trans "Due date" %}</td>
                                <td style="width: 180px">{% trans "Payment" %}</td>
                                <td style="width: 150px">{% trans "Method" %}</td>
                                <td></td>
                            </tr>
                        </thead>
                        <tbody>
                            {% for invoice in invoices %}
                                {% if invoice.status == "Pending" %}
                                    {% if forloop.counter == 1 %}
                                        <tr class="invoice pending" id="{{ invoice.id }}">
                                            <td class="item">{{ invoice.service.details | truncatechars:60 }}</td>
                                            <td class="amount">{{ invoice.amount }} {{ invoicing_config.currency }}</td>
                                            <td class="due_date">{{ invoice.due_date }}</td>
                                            <td class="paid_on"></td>
                                            <td class="payment-method"></td>
                                            <td class="action" style="padding: 6px 10px 7px; text-align: center">
                                                <a href="{% url 'billing:invoice_detail' invoice.id %}" class="button default">{% trans "Details" %}</a>
                                            </td>
                                        </tr>
                                    {% else %}
                                        <tr class="invoice pending" id="{{ invoice.id }}">
                                            <td class="item">{{ invoice.service.details | truncatechars:60 }}</td>
                                            <td class="amount">{{ invoice.amount }} {{ invoicing_config.currency }}</td>
                                            <td class="due_date">{{ invoice.due_date }}</td>
                                            <td class="paid_on"></td>
                                            <td class="payment-method"></td>
                                            <td class="action" style="padding: 6px 10px 7px; text-align: center">
                                                <a href="{% url 'billing:invoice_detail' invoice.id %}" class="button default">{% trans "Details" %}</a>
                                            </td>
                                        </tr>
                                    {% endif %}
                                {% elif invoice.status == "Overdue" or invoice.status == "Exceeded" %}
                                    <tr class="invoice overdue" id="{{ invoice.id }}">
                                        <td class="item">{{ invoice.service.details | truncatechars:60 }}</td>
                                        <td class="amount">{{ invoice.amount }} {{ invoicing_config.currency }}</td>
                                        <td class="due_date">{{ invoice.due_date }}</td>
                                        <td class="paid_on"></td>
                                        <td class="payment-method"></td>
                                        <td class="action" style="padding: 6px 10px 7px; text-align: center">
                                            <a href="{% url 'billing:invoice_detail' invoice.id %}" class="button default">{% trans "Details" %}</a>
                                        </td>
                                    </tr>
                                {% else %}
                                    <tr class="invoice" id="{{ invoice.id }}">
                                        <td class="item">{{ invoice.service.details | truncatechars:60 }}</td>
                                        <td class="amount">{{ invoice.amount }} {{ invoicing_config.currency }}</td>
                                        <td class="due_date">{{ invoice.due_date }}</td>
                                        <td class="paid_on">{{ invoice.paid_on }}</td>
                                        <td class="payment-method">{{ invoice.method }}</td>
                                        <td class="action" style="padding: 6px 10px 7px; text-align: center">
                                            <a href="{% url 'billing:invoice_detail' invoice.id %}" class="button default">{% trans "Details" %}</a>
                                        </td>
                                    </tr>
                                {% endif %}
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div>
                    {% trans "No pending invoice" %}
                </div>
            {% endif %}
        </div>
        <div class="clear"></div>
    </div>
{% endblock %}
{% block footer %}
    <footer>
        <div class="wrapper" style="height: 130px; padding-top: 30px">
            <nav style="float: left">
                <ul>
                    {% if contact_url %}
                        <li> <a href="{{ contact_url }}">{% trans "Contact" %}</a> </li>
                    {% endif %}
                    {% if about_url %}
                        <li> <a href="{{ about_url }}">{% trans "About us" %}</a> </li>
                    {% endif %}
                </ul>
            </nav>
            <div style="color: #888; float: right; font-size: .9em; margin-top: 1px; text-align: right">
                &copy; {{ year }} <a href="{{ website_url }}" style="color: #666; text-decoration: none"><strong>{{ company_name }}</strong></a>.
                {% trans "All rights reserved." %}
                {% if legal_mentions_url %}
                - <a href="{{ legal_mentions_url }}" style="color: #666; text-decoration: none">{% trans "Legal mentions" %}</a>
                {% endif %}
            </div>
            <div style="color: #888; border-top: solid 1px #DDD; clear: both; float: right; font-size: .9em; margin-top: 6px; padding-top: 3px; text-align: right; width: 100%">
                {% blocktrans %}
                    Powered by <a href="http://www.ikwen.com" style="color: #666; text-decoration: none"><strong>Ikwen</strong></a> &reg;.
                {% endblocktrans %}
            </div>
        </div>
    </footer>
    <script>
        (function() {
            $('div#lightbox .dialog .close').click(function() {
                $('#lightbox').hide('normal', function() {
                    $('div#lightbox .dialog').hide()
                })
            });
        })()
    </script>
{% endblock %}